<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Envoi au formulaire Google</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 16px;
            margin-bottom: 30px;
            border-radius: 4px;
        }

        .info-box h2 {
            font-size: 16px;
            color: #333;
            margin-bottom: 8px;
        }

        .info-box p {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        .results {
            margin: 20px 0;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .result-item .label {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .result-item .value {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .icon {
            margin-right: 8px;
        }

        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
            color: #c7254e;
        }

        .success {
            color: #28a745;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üß™ Test d'envoi au formulaire Google</h1>
        <p class="subtitle">Cette page permet de tester la fonctionnalit√© d'envoi des r√©sultats</p>

        <div class="info-box">
            <h2>üìã Comment √ßa marche ?</h2>
            <p>
                Ce bouton g√©n√®re une URL pr√©-remplie pour le formulaire Google Forms avec des r√©sultats de test.
                Cliquez sur le bouton pour ouvrir le formulaire et v√©rifier que les champs sont correctement remplis.
            </p>
        </div>

        <div class="results">
            <h2 style="margin-bottom: 16px; color: #333; font-size: 18px;">R√©sultats de test</h2>
            <div class="result-item">
                <span class="label">R√©sultat global</span>
                <span class="value">75%</span>
            </div>
            <div class="result-item">
                <span class="label">Domaine 1 : Informations et donn√©es</span>
                <span class="value">80%</span>
            </div>
            <div class="result-item">
                <span class="label">Domaine 2 : Communication et collaboration</span>
                <span class="value">85%</span>
            </div>
            <div class="result-item">
                <span class="label">Domaine 3 : Cr√©ation de contenu digital</span>
                <span class="value">60%</span>
            </div>
            <div class="result-item">
                <span class="label">Domaine 4 : R√©solution des probl√®mes</span>
                <span class="value">70%</span>
            </div>
            <div class="result-item">
                <span class="label">Domaine 5 : S√©curit√© num√©rique</span>
                <span class="value">80%</span>
            </div>
        </div>

        <button class="btn" onclick="openGoogleForm()">
            <span class="icon">üì§</span> Tester l'envoi au formulaire Google
        </button>

        <div id="status" style="margin-top: 20px; text-align: center; display: none;">
            <p class="success">‚úÖ Formulaire ouvert ! V√©rifiez le nouvel onglet.</p>
        </div>
    </div>

    <script>
        // Donn√©es de test simulant les r√©sultats du quiz
        const testResults = {
            'DOMAINE 1 : INFORMATIONS ET DONN√âES': { correct: 4, total: 5 },
            'DOMAINE 2 : COMMUNICATION ET COLLABORATION': { correct: 17, total: 20 },
            'DOMAINE 3 : CR√âATION DE CONTENU DIGITAL': { correct: 3, total: 5 },
            'DOMAINE 4 : R√âSOLUTION DES PROBL√àMES': { correct: 7, total: 10 },
            'DOMAINE 5 : S√âCURIT√â NUM√âRIQUE': { correct: 4, total: 5 },
            'global': 75
        };

        function generateGoogleFormsUrl() {
            // URL de base du formulaire
            const baseUrl = 'https://docs.google.com/forms/d/e/1FAIpQLSf2Sa6kudUT3hVMuhxFY0oNaedKbPuZu85yQnxqypY0Eohikg/viewform';

            // IDs des champs du formulaire Google Forms
            const formFields = {
                domaine1: 'entry.1390360142',  // RESULTAT DOMAINE 1
                domaine2: 'entry.494398783',   // RESULTAT DOMAINE 2
                domaine3: 'entry.818563881',   // RESULTAT DOMAINE 3
                domaine4: 'entry.1140857471',  // RESULTAT DOMAINE 4
                domaine5: 'entry.911865149',   // RESULTAT DOMAINE 5
                global: 'entry.294442511'      // RESULTAT GLOBAL
            };

            // Calculer les pourcentages pour chaque domaine
            const domain1 = testResults['DOMAINE 1 : INFORMATIONS ET DONN√âES'];
            const domain2 = testResults['DOMAINE 2 : COMMUNICATION ET COLLABORATION'];
            const domain3 = testResults['DOMAINE 3 : CR√âATION DE CONTENU DIGITAL'];
            const domain4 = testResults['DOMAINE 4 : R√âSOLUTION DES PROBL√àMES'];
            const domain5 = testResults['DOMAINE 5 : S√âCURIT√â NUM√âRIQUE'];

            const percentage1 = domain1.total > 0 ? Math.round((domain1.correct / domain1.total) * 100) : 0;
            const percentage2 = domain2.total > 0 ? Math.round((domain2.correct / domain2.total) * 100) : 0;
            const percentage3 = domain3.total > 0 ? Math.round((domain3.correct / domain3.total) * 100) : 0;
            const percentage4 = domain4.total > 0 ? Math.round((domain4.correct / domain4.total) * 100) : 0;
            const percentage5 = domain5.total > 0 ? Math.round((domain5.correct / domain5.total) * 100) : 0;
            const globalPercentage = testResults.global;

            // Construire l'URL avec les param√®tres
            const params = new URLSearchParams({
                [formFields.domaine1]: percentage1,
                [formFields.domaine2]: percentage2,
                [formFields.domaine3]: percentage3,
                [formFields.domaine4]: percentage4,
                [formFields.domaine5]: percentage5,
                [formFields.global]: globalPercentage
            });

            return `${baseUrl}?${params.toString()}`;
        }

        function openGoogleForm() {
            const url = generateGoogleFormsUrl();

            console.log('üì§ Ouverture du formulaire Google Forms...');
            console.log('üìä URL g√©n√©r√©e:', url);
            console.log('üìã R√©sultats √† envoyer:', testResults);

            // Ouvrir le formulaire pr√©-rempli dans un nouvel onglet
            const formWindow = window.open(url, '_blank');

            if (formWindow) {
                // Afficher le message de succ√®s
                document.getElementById('status').style.display = 'block';
                alert('‚úÖ Le formulaire Google Forms a √©t√© ouvert dans un nouvel onglet.\n\nüìã Les r√©sultats sont d√©j√† pr√©-remplis.\nV√©rifiez que tous les champs correspondent aux valeurs affich√©es sur cette page.');
            } else {
                // Si le popup a √©t√© bloqu√©
                alert('‚ö†Ô∏è Le navigateur a bloqu√© l\'ouverture du formulaire.\n\nVeuillez autoriser les fen√™tres pop-up ou copier ce lien:\n' + url);
                console.log('URL du formulaire:', url);

                // Copier l'URL dans le presse-papiers
                navigator.clipboard.writeText(url).then(() => {
                    alert('‚úÖ L\'URL a √©t√© copi√©e dans le presse-papiers !');
                }).catch(() => {
                    console.error('Impossible de copier l\'URL');
                });
            }
        }
    </script>
</body>

</html>